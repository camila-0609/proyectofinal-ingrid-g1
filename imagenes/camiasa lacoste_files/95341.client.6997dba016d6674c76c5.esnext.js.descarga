"use strict";(self.webpackChunk_portal_app_portal_cr=self.webpackChunk_portal_app_portal_cr||[]).push([[95341],{95341:(e,t,o)=>{o.d(t,{APPLE_ACCOUNT_LINKING_VIEW:()=>b,CHECKOUT_GUEST_REGISTRATION_LOGIN_TYPE:()=>w,CHECKOUT_LOGIN_MODAL_VIEW:()=>E,CHECKOUT_MODAL_LOGIN_TYPE:()=>f,CHECKOUT_PAGE_LOGIN_TYPE:()=>O,EMAIL_CONFIRMATION_VIEW:()=>R,EMAIL_VALIDATION_ERROR_VIEW:()=>V,EMAIL_VALIDATION_RETRY_VIEW:()=>j,EMAIL_VALIDATION_VIEW:()=>N,FACEBOOK_ACCOUNT_LINKING_VIEW:()=>I,FORGOT_PASSWORD_CONFIRM_VIEW:()=>M,FORGOT_PASSWORD_VIEW:()=>T,GOOGLE_ACCOUNT_LINKING_VIEW:()=>A,GOOGLE_ONE_TAP_ACCOUNT_LINKING_VIEW:()=>S,GUEST_TAB_NAME:()=>c,LOGIN_TAB_NAME:()=>d,LoginProvider:()=>eP,LoginProviderWithInitialState:()=>ey,REGISTER_TAB_NAME:()=>g,RESET_PASSWORD_LINK_EXPIRED_VIEW:()=>k,RESET_PASSWORD_SUCCESS_VIEW:()=>C,RESET_PASSWORD_VIEW:()=>y,UNIVERSAL_LOGIN_MODAL_VIEW:()=>m,UNIVERSAL_MODAL_LOGIN_TYPE:()=>p,VERIFICATION_CODE_VIEW:()=>L,VIP_LOGIN_VIEW:()=>P,VIP_PAGE_LOGIN_TYPE:()=>h,performanceMarks:()=>v,useLogin:()=>r});var n=o(2784);let i=(0,n.createContext)({isCheckout:!1,isLoginModalOpened:!1,isLoginBottomSheetOpened:!1,isLoginFallbackPage:!1,shouldOpenLoginOnWishlistCTA:!1,loginType:"na",defaultTab:"",trackingArea:"",closeLoginModal:()=>{},openLoginModal:(e,t)=>{},setOnCloseLoginModal:e=>{},openCheckoutLoginModal:e=>{},openWishlistLoginModal:e=>{},loginModalOptions:{onCloseLoginModal:()=>{},onLoginSuccess:async()=>{},onRegisterSuccess:async()=>{},onWechatAuthentication:async()=>{},skipFallbackToPage:!1,headerTitle:null,headerDescription:null,trackingArea:null},isVipBr:!1,isDebug:!1,view:{currentView:"",previousView:"",setView:e=>{},returnToPreviousView:()=>{},isAccountLinking:!1,isAccountLinkingConfirmation:!1,setIsAccountLinkingConfirmation:e=>{},isEmailLessForgotPassword:!1,setIsEmailLessForgotPassword:e=>{},isVipPage:!1},bottomSheet:{shouldOpen:!1,shouldOpenOnAddToWishlist:!1,setShouldOpen:e=>{},open:e=>{}},user:{isLogged:!1,emailRef:{current:""}},accountLinking:{email:"",token:""},setAccountLinking:e=>{},redirectResult:"",setRedirectResult:e=>{},setAdd2WishlistCooldown:()=>{},shouldSetAdd2WishListCooldown:!1,isCooldownPeriodOver:!1}),r=()=>(0,n.useContext)(i);var a=o(28165);let l="login.aspx",u="checkout/login.aspx",s="from",c="guest",d="login",g="register",v={NAME:"loginmodal",START:"loginmodal.start",LOADED:"loginmodal.loaded",END:"loginmodal.end",TIME_TO_LOAD:"TTLLM",TIME_TO_INTERACTIVE:"TTILM"},p="universal_modal",f="checkout_modal",_="universal_page",O="checkout_page",w="checkout_guest_registration_page",h="vip_page",m="universal-login-modal",E="checkout-login-modal",L="verification-code-modal",b="apple-account-linking",A="google-account-linking",S="google-one-tap-account-linking",I="facebook-account-linking",P="vip-login",T="forgot-password",y="reset-password",k="reset-password-link-expired",C="reset-password-success",M="forgot-password-confirm",R="email-confirmation",N="email-validation",V="email-validation-error",j="email-validation-retry",W=[b,A,I],D=[m,E,b,A,S,I,L,T,M,y,k,C,P,R,N,V,j],G="UniversalLogin",F="CheckoutLogin",U="VipLogin",x="ForgotPassword",K="ResetPassword",B="ResetPasswordLinkExpired",Y="#login",H="#register",X="_add2wl_lgn";function $(e){return!!window.location.pathname.endsWith(e)}function q(e){let t=$(l),o=e.has("campaign");return t&&o}function z(e){let t=$(l),o=e.has(s)&&"confirmationpage"===e.get(s);return t&&o}function J(){var e,t;if("undefined"==typeof window)return null;let o=null===(e=window)||void 0===e?void 0:null===(t=e.location)||void 0===t?void 0:t.pathname.split("/");return o.includes("farfetch-partnership")?"ff_partnership":null}function Q(e){return e===_||e===w||e===O||e===h}function Z(){var e,t;if(!$("checkout/basket.aspx"))return!1;let o=new URLSearchParams(null===(e=window)||void 0===e?void 0:null===(t=e.location)||void 0===t?void 0:t.search);return o.has("clm")&&"open"===o.get("clm")}function ee(){var e,t;if("undefined"==typeof window)return"na";let o=new URLSearchParams(null===(e=window)||void 0===e?void 0:null===(t=e.location)||void 0===t?void 0:t.search);return z(o)?w:!$(l)||$(u)||q(o)?$(u)?O:q(o)?h:"na":_}let et={[G]:m,[F]:E,FromCheckoutConfirmationPage:"from-checkout-confirmation-page",[U]:P,[x]:T,[K]:y,[B]:k,EmailValidation:N,EmailValidationError:V},eo={[G]:_,[F]:O,[U]:h,[x]:_,[K]:_,[B]:_},en=e=>null!==e&&"object"==typeof e,ei=e=>"function"==typeof e,er=e=>"boolean"==typeof e,ea=e=>"string"==typeof e,el=localStorage,eu=()=>{window.location.replace("#"),"function"==typeof window.history.replaceState&&history.replaceState({},"",window.location.href.slice(0,-1))};function es(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function ec(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?es(Object(o),!0).forEach(function(t){ed(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):es(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function ed(e,t,o){return(t=eg(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function eg(e){var t=ev(e,"string");return"symbol"==typeof t?t:String(t)}function ev(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}let ep={onCloseLoginModal:()=>{},onLoginSuccess:async()=>{},onRegisterSuccess:async()=>{},onBeforeRedirect:()=>"",onWechatAuthentication:async()=>{},skipFallbackToPage:!1,headerTitle:null,headerDescription:null,trackingArea:null},ef=()=>ec(ec({},ep),{},{trackingArea:J()}),e_=e=>{let t=ef();if(!en(e))return t;let{onCloseLoginModal:o,onLoginSuccess:n,onRegisterSuccess:i,onBeforeRedirect:r,onWechatAuthentication:a,skipFallbackToPage:l,headerTitle:u,headerDescription:s,trackingArea:c}=e;return ec(ec(ec(ec(ec(ec(ec(ec(ec(ec({},t),ei(o)&&{onCloseLoginModal:o}),ei(n)&&{onLoginSuccess:n}),ei(i)&&{onRegisterSuccess:i}),ei(r)&&{onBeforeRedirect:r}),ei(a)&&{onWechatAuthentication:a}),er(l)&&{skipFallbackToPage:l}),ea(u)&&{headerTitle:u}),ea(s)&&{headerDescription:s}),ea(c)&&{trackingArea:c})};var eO=o(497),ew=o(76699),eh=o(52034),em=o.n(eh);function eE(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function eL(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?eE(Object(o),!0).forEach(function(t){eb(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):eE(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function eb(e,t,o){return(t=eA(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function eA(e){var t=eS(e,"string");return"symbol"==typeof t?t:String(t)}function eS(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}let eI=[d,g],eP=e=>{var t,o,r,l,u,s;let{initialState:c,features:_,children:w}=e,{t:L}=(0,ew.$)(),[b,A]=(0,n.useState)((null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.isLogged)||null),S=null==c?void 0:null===(o=c.page)||void 0===o?void 0:o.loginPageType,[I,P]=(0,n.useState)(!1),[T,y]=(0,n.useState)(!1),[k,C]=(0,n.useState)(d),[M,R]=(0,n.useState)({}),[N,V]=(0,n.useState)(S&&eo[S]||ee()),[j,G]=(0,n.useState)(""),[F,U]=(0,n.useState)(!1),[x,K]=(0,n.useState)(!1),[B,$]=(0,n.useState)(N===O||N===f),q=(0,n.useRef)(""),[z,J]=(0,n.useState)(S&&et[S]||(B?E:m)),[en,ei]=(0,n.useState)(""),[er,ea]=(0,n.useState)({email:"",token:""}),[es,ec]=(0,n.useState)(!1),[ed,eg]=(0,n.useState)(!1),[ev,ep]=(0,n.useState)(""),ef=(null==_?void 0:null===(r=_.wishlist)||void 0===r?void 0:null===(l=r.options)||void 0===l?void 0:l.should_open)==="true",eh=(null==_?void 0:null===(u=_.wishlist)||void 0===u?void 0:null===(s=u.options)||void 0===s?void 0:s.show_bottom_sheet)==="true",[eE,eb]=(0,n.useState)(Date.now()>parseInt((null==el?void 0:el.getItem(X))||"0"));(0,n.useEffect)(()=>{let e=N===O||N===f;($(e),e&&z!=E)?(ei(z),J(E)):e||z!==E||(ei(E),J(en))},[N]),(0,n.useEffect)(()=>{ed&&0>W.indexOf(z)&&eg(!1)},[z,ed]);let eA=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,eO.markMetric)(v.START),V(p),R(e_(t)),e&&-1!==eI.indexOf(e)||(e=d),C(e),P(!0)},eS=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,eO.markMetric)(v.START),V(f),R(e_(e)),C(d),P(!0)},eP=()=>{var e;let t=(null===(e=window.universal_variable.user)||void 0===e?void 0:e.isLogged)||!1;A(t),!t&&Z()&&eS()},eT=()=>{var e,t;(null===(e=window.location.href.match(/login.aspx/gi))||void 0===e?void 0:e.length)!==1&&(null!==(t=window.universal_variable.user)&&void 0!==t&&t.isLogged?[Y,H].includes(location.hash)&&eu():location.hash===Y?eA("",{trackingArea:"navigation_url",onCloseLoginModal:eu}):location.hash===H&&eA(g,{trackingArea:"navigation_url",onCloseLoginModal:eu}))},ey=e=>{R(e_(eL(eL({},M),{},{onCloseLoginModal:e})))};(0,n.useEffect)(()=>{var e,t,o;if(U("True"===em().get("ckm-rms-vbr")),K((null===(e=em().get("ff_debug"))||void 0===e?void 0:e.includes("slice-login"))||!1),window.addEventListener("hashchange",()=>{eT()}),null!==(t=window.universal_variable)&&void 0!==t&&t.user){eP(),eT();return}let n=new URLSearchParams(null===(o=window.location)||void 0===o?void 0:o.search);return"register"===n.get("option")&&C(g),document.addEventListener("universal_variable.user",()=>{eP(),eT()}),()=>{document.removeEventListener("universal_variable.user",eP),window.removeEventListener("hashchange",eT)}},[]);let ek=(0,n.useMemo)(()=>({user:{isLogged:b,emailRef:q},isCheckout:B,loginType:N,isLoginModalOpened:I,isLoginBottomSheetOpened:T,defaultTab:k,trackingArea:j,isLoginFallbackPage:Q(N),closeLoginModal:()=>P(!1),openLoginModal:eA,setOnCloseLoginModal:ey,openCheckoutLoginModal:eS,openWishlistLoginModal:e=>{eA(d,{trackingArea:e,headerTitle:L("wbt_slice_login_to_add_to_wishlist","Sign in to save your wishlist"),skipFallbackToPage:!0})},loginModalOptions:M,isVipBr:F,isDebug:x,view:{currentView:z,previousView:en,setView:e=>{let t=D.indexOf(e)>-1?e:B?E:m;ei(z),J(t)},returnToPreviousView:()=>{ei(z),J(en)},isAccountLinking:W.indexOf(z)>=0,isAccountLinkingConfirmation:ed,setIsAccountLinkingConfirmation:eg,isEmailLessForgotPassword:es,setIsEmailLessForgotPassword:ec,isVipPage:h===N},bottomSheet:{shouldOpen:T,setShouldOpen:y,open:e=>{y(!0),G(e)},shouldOpenOnAddToWishlist:eh},accountLinking:er,setAccountLinking:ea,redirectResult:ev,setRedirectResult:ep,shouldOpenLoginOnWishlistCTA:!b&&ef&&eE,setAdd2WishlistCooldown:()=>{let e=Date.now()+2592e6;null==el||el.setItem(X,e.toString()),eb(!1)},isCooldownPeriodOver:eE,shouldSetAdd2WishListCooldown:(null==M?void 0:M.trackingArea)==="atw_pdp_button"||(null==M?void 0:M.trackingArea)==="atw_plp_icon"}),[b,q,B,N,I,T,k,j,M,F,x,z,en,ed,es,er,ev,eh,ef,eE,L]);return(0,a.jsx)(i.Provider,{value:ek},w)};var eT=o(32660);let ey=(0,eT.g1)(eP,"slice-login")},497:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var i=Object.getOwnPropertyDescriptor(t,o);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,i)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),i=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),i(o(33147),t)},33147:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCustomAttribute=t.throwNewRelicError=t.measureAndRecordMetric=t.recordMetric=t.measureMetric=t.markMetric=void 0;var o=function(e){try{return e()}catch(t){return null}},n=function(e){return o(function(){var t;return null===(t=window.performance)||void 0===t?void 0:t.mark(e)})};t.markMetric=n;var i=function(e,t,n){return o(function(){var o,i=null===(o=window.performance)||void 0===o?void 0:o.measure(e,t,n),r=i.duration,a=i.startTime;return{duration:r.toFixed(2),startTime:a.toFixed(2)}})};t.measureMetric=i;var r=function(e,t){return o(function(){var o;return null===(o=window.newrelic)||void 0===o?void 0:o.addPageAction(e,t)})};t.recordMetric=r;var a=function(e,o,n){var i=(0,t.measureMetric)(e,o,n);i&&(0,t.recordMetric)(e,i)};t.measureAndRecordMetric=a;var l=function(e,t){return o(function(){var o;return null===(o=window.newrelic)||void 0===o?void 0:o.noticeError(e,t)})};t.throwNewRelicError=l;var u=function(e,t){return o(function(){var o;return null===(o=window.newrelic)||void 0===o?void 0:o.setCustomAttribute(e,t)})};t.addCustomAttribute=u}}]);